
# Generate the DDR3 IP for the XEM7350-160KT Opal Kelly board

To configure the DDR3 for the XEM7350 Opal Kelly board, we have 3 solutions:
> - Solution1: On a existing Vivado project, manually generate and configure the MIG (Memory Interface generator).
> - Solution2: Create a new temporary Vivado project file by using the Vivado Board Files provided by Opal Kelly.
> - Solution3: Combine the 2 previous method.


**Note**:
> - The solution 3 will be used in order to not add additional dependency and to be sure of the DDR parameter configuration.


## Solution 1:


On an existing Vivado project, do the following steps:
> 1. Open the IP Catalog: Project Manager -> IP Catalog
> 2. In the search area, type : MIG (Memory Interface Generator) and double clic on the name.
> 3. configure the DDR3 parameters as defined in the Opal Kelly website: https://docs.opalkelly.com/xem7350/ddr3-memory/
> 4. In the Pin/Bank selection, use the XEM7350.xdc pinout file provided by Opal kelly website: https://pins.opalkelly.com/pin_list/XEM7350
> 5. Vivado generates 2 master IP files (*.xci and *.prj) in its "project_name.srcs" subdirectory. **Note**: the synthetized files will be generated in a separate directory ("project_name.gen")

Note:
> - The XEM7350.xdc needs to be edited. The wildcard (\*) characters is not recognized as regexp by the IP. For example, set_property SLEW FAST [get_ports {ddr3_dm[*]}] needs to be translated into:
>> - set_property SLEW FAST [get_ports {ddr3_dm[0]}]
>> - set_property SLEW FAST [get_ports {ddr3_dm[1]}]

> - if the 2 master IP files (*.xci and *.prj) needs to be moved, we can force the synthetized files to be generated in the same directory as the master files. To do that,
>> -  **close** the Vivado project
>> -  **edit** the *.xci file. 
>>> - Search the "RUNTIME_PARAM.OUTPUTDIR" parameter
>>> - modify its "../../../../project_name.gen/sources_1/ip/ip_name" value  by "."

The advantages of this method are:
> - No added dependency in the Vivado project.
> - IP name is defined by the user.

The Drawbacks of this method are:
> - Some parameters can be misconfigured (potential errors).

## Solution 2:

> 1. Create a new Vivado project by using the Vivado Board files provided by Opal Kelly. The procedure is described at the Opal Kelly website: https://docs.opalkelly.com/fpsdk/frontpanel-hdl/vivado-board-files/ (section 1.1, section 2.1, section 2.1.1).
> 2. It generates 2 master files:
>> 1. a *.xci in its project "project_name.srcs" subdirectory
>> 2. a mig.prj globally defined in the vivado-board-files location.


The advantages of this method are:
> - No errors on the configuration of the DDR3 parameters.

The Drawbacks of this method are:
> - Add path dependency to the Vivado project (path to the Opal Kelly vivado board files).
>> This behaviour can be annoying when the vivado project file is tracked by Git. Indeed, on the new PC, the user might need to manually redefine this path.


## Solution 3

1. Do Steps of the "Solution 2" chapter.
2. Do steps of the "solution 1" chapter.

Compare the *.xci of the 2 solutions. The DDR parameter of the "solution 1" should match the DDR parameter of the solution 2.

**Note**:
> we can't copy the IP generated by the solution 2 in an existing Vivado project because the *.xci file contains some problematic paths. This file needs to be correctly edited in order to work perfectly (no path dependency).


# Generate FIFO

These IPs are generated as usual. No particular action to do.